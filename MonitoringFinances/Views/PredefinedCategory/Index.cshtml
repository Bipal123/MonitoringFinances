@model IEnumerable<MonitoringFinances.Models.AdminModels.PredefinedCategory>
@{
    int counter = 1;
}
<div class="container">
    <div class="row my-3">
        <div class="col-12 col-md-5 p-3 ">
            <h1 class="display-5">
                Predefined Categories
            </h1>
        </div>
        <div class="col-12 col-md-4 offset-md-3 text-end d-flex align-items-center justify-content-md-end">
            <a class="btn btn-primary px-4 fs-5" onclick="UpSert(0)">
                <i class="fas fa-plus"></i>&nbsp;Create New
            </a>
        </div>
    </div>
    <div class="row my-3">
        @if (Model.Count() > 0)
        {
            <div class="row my-3">
                <div class="">
                    <table class="table table-striped text-center align-middle">
                        <thead>
                            <tr>
                                <th scope="col" class="fs-4">#</th>
                                <th scope="col" class="fs-4">Name</th>
                                <th scope="col" class="fs-4">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var preDefinedCategory in Model)
                            {
                                <tr>
                                    <th scope="row" class="fs-5">@counter</th>
                                    <td class="fs-4">@preDefinedCategory.Name</td>
                                    <td class="text-center">
                                        <div class="w-50 btn-group" role="group">
                                            <a onclick="UpSert(@preDefinedCategory.Id)" class="btn btn-primary mx-2">
                                                <i class="fas fa-edit"></i>
                                            </a>
                                            <a asp-controller="Category" asp-route-Id="@preDefinedCategory.Id" asp-action="Delete" class="btn btn-danger mx-2">
                                                <i class="far fa-trash-alt"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                counter++;
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        }
        else
        {
            <div class="col p-3">
                <p class="lead">No Predefined Categories Exists!</p>
            </div>
        }
    </div>
</div>

<!--Create/Edit Category Modal-->
<div class="modal fade" id="UpSertPredefinedCategoryModal" role="dialog" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modal-title">Create PredefinedCategory</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="UpSertPredefinedCategoryModalBody">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button id="UpSertPredefinedCategoryFormButton" form="UpSertPredefinedCategoryForm" type="button" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        /*
         * Javascript function to create or edit predefined categories
        */
        var UpSert = function (Id) {
            console.log("Some Text" + Id);
            var url = "/PredefinedCategory/UpSert?Id=" + Id;
            if (Id > 0)
                $('#modal-title').html("Edit PredefinedCategory");
            $("#UpSertPredefinedCategoryModalBody").load(url, function () {
                $("#UpSertPredefinedCategoryModal").modal("show");
            });
        }

        $('body').on('click', "#UpSertPredefinedCategoryFormButton", function () {
            var myformdata = $("#UpSertPredefinedCategoryForm").serialize();
            $.ajax({
                type: "POST",
                url: "/PredefinedCategory/UpSert",
                data: myformdata,
                success: function () {
                    window.location.href = "/PredefinedCategory/Index";
                },
                error: function (errormessage) {
                    alert(errormessage.responseText);
                }
            })
        })
    </script>
    
}